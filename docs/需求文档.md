# WebSocket 调试工具 - 需求文档

## 1. 项目概述

**项目名称**：WebSocket 调试工具

**项目类型**：单页 Web 应用（纯前端）

**技术栈**：HTML5 + CSS3 + 原生 JavaScript（ES6+）

**目标**：为前端开发者提供 WebSocket 协议的调试能力，类似 Postman 的 WebSocket 版本。

---

## 2. 功能需求

### 2.1 连接管理

| 功能 | 描述 | 优先级 |
|------|------|--------|
| URL 输入 | 支持输入 WebSocket 服务器地址 | P0 |

### 2.2 消息功能

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 发送消息 | 向服务器发送文本消息 | P0 |
| 接收消息 | 实时接收服务器推送的消息 | P0 |
| 消息历史 | 显示发送/接收的消息记录 | P0 |
| JSON 格式化 | 自动美化 JSON 格式 | P0 |
| 语法高亮 | JSON 键值对颜色区分 | P0 |
| 复制消息 | 一键复制消息内容 | P1 |
| 清空消息 | 清除消息历史记录 | P1 |

### 2.3 心跳机制

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 启用心跳 | 开关控制是否发送心跳 | P1 |
| 发送间隔 | 配置心跳间隔时间（秒） | P1 |
| 模板选择 | 从已有模板中选择心跳内容 | P1 |
| 手动输入 | 自定义心跳消息内容 | P1 |

### 2.4 自动重连

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 启用重连 | 开关控制是否自动重连 | P1 |
| 最大次数 | 配置最大重试次数 | P1 |
| 重连间隔 | 配置重连间隔时间（秒） | P1 |

### 2.5 消息模板

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 添加模板 | 新建消息模板（名称+内容+快捷键） | P1 |
| 删除模板 | 移除已有模板 | P1 |
| 使用模板 | 快速发送模板消息 | P1 |
| 快捷键发送 | 按 1-9 数字键快速发送模板 | P1 |

### 2.6 配置管理

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 导出配置 | 导出全部配置为 JSON 文件 | P1 |
| 导入配置 | 从 JSON 文件导入配置 | P1 |
| 本地存储 | 自动保存/恢复配置 | P1 |
| 清除数据 | 清除所有本地数据 | P2 |

---

## 3. 非功能需求

### 3.1 性能需求
- 页面加载时间 < 1 秒
- 消息收发延迟 < 100ms
- 内存占用 < 50MB

### 3.2 兼容性
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

### 3.3 界面需求
- 左右分栏布局
- 深色主题
- 响应式设计
- 流畅的动画效果

### 3.4 安全需求
- 本地数据加密存储
- 不向第三方发送数据

---

## 4. UI 设计

### 4.1 主页面布局

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ WebSocket 调试工具                                            [📤][📥][📝][⚙️] │
├───────────────────────────┬───────────────────────────────────────────────┤
│                           │                                               │
│  连接配置                 │  消息区域                            [🟢 已连接] │
│  ───────────────────────  │  ──────────────────────────────────────────── │
│                           │                                               │
│  URL: [wss://echo.websocket.org____________________]                      │
│                           │  ┌───────────────────────────────────────────┐ │
│  [连接] [断开]      │  │ 11:23:45 [发送] {"type":"ping"}           │ │
│                           │  │ 11:23:46 [接收] {"type":"pong"...}        │ │
│  ┌─ 心跳配置 ─────────┐   │  │ 11:23:47 [发送] {"event":"login"...}   │ │
│  │ [✓] 启用心跳       │   │  │                                           │ │
│  │ 间隔: [30] 秒      │   │  │                          [消息数: 3]    │ │
│  │                     │   │  └───────────────────────────────────────────┘ │
│  │ ○ 选择模板 ○ 手动   │   │                                               │
│  │ [选择模板 ▼]        │   │  ┌───────────────────────────────────────────┐ │
│  └────────────────────┘   │  │ 消息输入: [{"type":"ping"}______] [发送] │ │
│                           │  └───────────────────────────────────────────┘ │
│  ┌─ 自动重连 ─────────┐   │                                               │
│  │ [✓] 启用自动重连   │   │                                               │
│  │ 最大次数: [5] 次   │   │                                               │
│  │ 间隔: [3] 秒        │   │                                               │
│  └────────────────────┘   │                                               │
│                           │                                               │
│                                                │
│                           │                                               │
│                                                            │
│                           │                                               │
└───────────────────────────┴───────────────────────────────────────────────┘
```

### 4.2 模板管理弹窗布局

```
┌─────────────────────────────────────────────────────────────┐
│ 消息模板管理                                    [×] 关闭   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 模板名称: [ping________________] 快捷键: [1▼]      │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ 模板内容 (JSON):                                      │   │
│  │ [{"type":"ping"}_______________________________]    │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │                     [添加模板]                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ───────────────────────────────────────────────────────   │
│                                                             │
│  模板列表:                                                  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📄 Ping                          [1]    [删除]    │   │
│  │ {"type":"ping"}                                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📄 Pong                          [2]    [删除]    │   │
│  │ {"type":"pong"}                                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📄 Login                         [3]    [删除]    │   │
│  │ {"event":"login"...}                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4.3 设置弹窗布局

```
┌─────────────────────────────────────────────────────────────┐
│ 设置                                              [×] 关闭   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ✓ 自动格式化 JSON 消息                               │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ ✓ 启用语法高亮                                      │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ ✓ 显示快捷键提示                                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ───────────────────────────────────────────────────────   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              [清除所有数据]                        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4.4 配色方案

| 用途 | 颜色 | 说明 |
|------|------|------|
| 背景 | #1e1e2e | 深色背景 |
| 发送消息 | #a6e3a1 | 绿色 |
| 接收消息 | #89b4fa | 蓝色 |
| 系统消息 | #f9e2af | 黄色 |
| 错误 | #f38ba8 | 红色 |
| 成功 | #a6e3a1 | 绿色 |

---

## 5. 数据结构

### 5.1 配置存储

```json
{
  "url": "wss://echo.websocket.org",
  "protocol": "wss",
  "heartbeat": {
    "enabled": true,
    "interval": 30,
    "mode": "template",
    "templateId": "1",
    "customMessage": "{\"type\":\"ping\"}"
  },
  "reconnect": {
    "enabled": true,
    "maxAttempts": 5,
    "interval": 3
  },
  "headers": "[{\"key\":\"Auth\",\"value\":\"xxx\"}]",
  "templates": [
    {
      "id": "1",
      "name": "Ping",
      "content": "{\"type\":\"ping\"}",
      "shortcut": "1"
    }
  ],
  "settings": {
    "autoFormatJson": true,
    "syntaxHighlight": true
  }
}
```

### 5.2 消息对象

```json
{
  "id": 1707638626000,
  "type": "send" | "receive" | "system",
  "content": "原始消息内容",
  "timestamp": 1707638626000,
  "timeString": "11:23:46"
}
```

---

## 6. 快捷键说明

| 快捷键 | 功能 |
|--------|------|
| `1-9` | 快速发送对应快捷键的模板 |
| `Ctrl + Enter` | 发送消息 |
| `Esc` | 断开连接 / 关闭弹窗 |

---

## 7. 版本规划

| 版本 | 功能 |
|------|------|
| V1.0 | 基础连接、消息收发、JSON 格式化 |
| V1.1 | 心跳配置、自动重连 |
| V1.2 | 消息模板、快捷键发送 |
| V1.3 | 配置导入导出、本地存储 |

---

## 8. 附录

### 8.1 参考工具
- Postman（API 调试）
- websocat（命令行工具）
- Chrome DevTools（Network 面板）

### 8.2 术语说明
- **WebSocket**：一种网络通信协议，提供全双工通信
- **心跳**：定期发送的探测消息，用于保持连接活跃
- **重连**：连接断开后自动重新建立连接
